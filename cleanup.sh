#!/bin/bash
# ===============================================================
#  cleanup.sh — Очистка Docker-среды проекта
# ---------------------------------------------------------------
#  Удаляет неиспользуемые образы, контейнеры и кэш сборки,
#  чтобы освободить место после экспериментов.
#
#  Автор: Михаил Шардин
#  Онлайн-визитка: https://shardin.name/?utm_source=python
#
#  Репозиторий: https://github.com/empenoso/llm-stock-market-predictor
# ===============================================================

set -e

# Название образа и тег для удаления
IMAGE_NAME="llm_predictor"
IMAGE_TAG="latest"

echo "#####################################################"
echo "### Удаление Docker-образа: ${IMAGE_NAME}:${IMAGE_TAG}"
echo "#####################################################"

# Удаляем образ, игнорируя ошибку, если его не существует
docker rmi "${IMAGE_NAME}:${IMAGE_TAG}" 2>/dev/null || true

echo "### Очистка кэша сборщика Docker..."
# Принудительно очищаем кэш сборки
docker builder prune -f

echo "### Очистка завершена."